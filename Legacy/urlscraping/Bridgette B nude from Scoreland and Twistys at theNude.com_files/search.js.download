/**
 * File manages advanced search form
 */

    /* Event handler uses jQuery, rest of the code should be vanilla JS */
    $(".search-model-btn-more-options").on('click', function(event) {
        event.preventDefault();

        /* Make sure to operate only on searchForm - the form that contains event target */
        var searchForm = $(this).closest("form").get(0);
        toggleShowMoreSearchOptions(searchForm);
    });

    /**
     * @vanillajs
     * @param element
     */
    function toggleAdvancedSearchFieldsVisibility(element) {
        /**
         * Determine if element is visible based on
         * https://stackoverflow.com/questions/19669786/check-if-element-is-visible-in-dom/33456469
         */
        if(isVisible(element)) {
            element.style.display = 'block';
        } else {
            element.style.display = 'none';
        }
    }

    function isVisible(element) {
        return element.offsetParent === null;
    }

    /**
     * @vanillajs
     * @param searchForm
     */
    function toggleShowMoreSearchOptions(searchForm) {
        var searchFields = searchForm.querySelectorAll(".advanced-search-fields");
        /* First change the text on button because the check depends on visibility that we're about to change */
        var btn = searchForm.querySelector(".search-model-btn-more-options");
        if(isVisible(searchFields[0])) {
            btn.setAttribute("value", btn.getAttribute("data-text-on"));
        } else {
            btn.setAttribute("value", btn.getAttribute("data-text-off"));
        }
        searchFields.forEach(toggleAdvancedSearchFieldsVisibility);
    }

    /**
     * @vanillajs
     * @returns {boolean}
     */
    function isShowMoreSearchOptionsSettingEnabled() {
        return memberSettings.showAdvancedSearchOptions || false;
    }